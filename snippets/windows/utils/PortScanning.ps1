$ErrorActionPreference = "SilentlyContinue"
$ports = 1..65535
$ip = "VAR_TARGET_HOST"

foreach ($port in $ports) {
    if(Test-Connection -BufferSize 32 -Count 1 -Quiet -ComputerName $ip) {
        $socket = new-object System.Net.Sockets.TcpClient($ip, $port)
        If($socket.Connected) {
            "$ip:$port"
            $socket.Close()
        }
    }
}