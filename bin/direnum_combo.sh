#!/bin/bash

if [[ -z $1 ]]; then
    echo "Usage: $0 http://example.com"
    exit 1
fi

shopt -s extglob
TARGET=${1%%+(/)}
USERAGENT="User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.74 Safari/537.36 Edg/79.0.309.43"
echo "Checking... $TARGET"
echo "Using $USERAGENT"

~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-usernames.txt -H "$USERAGENT" -u $TARGET/~FUZZ
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt -H "$USERAGENT" -u $TARGET/FUZZ
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt -H "$USERAGENT" -u $TARGET/FUZZ/
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt -H "$USERAGENT" -u $TARGET/.FUZZ
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt -H "$USERAGENT" -u $TARGET/.FUZZ/
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt:PATH -w ~/lib/brutas/brutas-extensions.txt:EXT -H "$USERAGENT" -u $TARGET/PATHEXT
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt:PATH -w ~/lib/brutas/brutas-extensions.txt:EXT -H "$USERAGENT" -u $TARGET/.PATHEXT
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt -H "$USERAGENT" -u $TARGET/_FUZZ
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt -H "$USERAGENT" -u $TARGET/__FUZZ
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt:PATH -w ~/lib/brutas/brutas-extensions.txt:EXT -H "$USERAGENT" -u $TARGET/_PATHEXT
~/go/bin/ffuf -ac -w ~/lib/brutas/brutas-http-paths.txt:PATH -w ~/lib/brutas/brutas-extensions.txt:EXT -H "$USERAGENT" -u $TARGET/__PATHEXT