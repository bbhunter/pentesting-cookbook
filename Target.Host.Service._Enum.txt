`` Service discovery

    ~$ nmap -sS -Pn -n -v VAR_TARGET_CIDR
    ~$ proxychains -q nmap -sT -Pn -n -v VAR_TARGET_CIDR
    ~$ nmap --script smb-os-discovery --script-args=unsafe=1 -p 445 VAR_TARGET_CIDR
    ~$ nmap -sU --open -p 161 VAR_TARGET_CIDR
    ~$ nmap -v -p 139,445 VAR_TARGET_CIDR
    ~$ nmap -v -p 21 --script ftp-anon VAR_TARGET_CIDR

    `` PowerShell

        `` With simple range-based port scanning

            >$ 1..254 | % { $a = $_; 1..1024 | % {echo ((new-object Net.Sockets.TcpClient).Connect("192.168.1.$a",$_)) "Port $_ is open!"} 2>$null}

        `` With simple list-based port scanning

            >$ 1..254 | % { $a = $_; write-host "------"; write-host "192.168.1.$a"; 22,53,80,445 | % {echo ((new-object Net.Sockets.TcpClient).Connect("192.168.1.$a",$_)) "Port $_ is open!"} 2>$null}

`` TCP

    ~$ hping3 -S -8 1-65535 VAR_TARGET_HOST | grep -v 'Not responding'
    ~$ hping3 -S -c 3 -s 53 -p 80 VAR_TARGET_HOST
    ~$ nmap -sS -Pn -v -n --top-ports 500 VAR_TARGET_HOST
    ~$ nmap -T4 -Pn -sT -n -v --top-ports 2500 VAR_TARGET_HOST
    ~$ proxychains -q nmap -T4 -Pn -sT -A -n -v --top-ports 2500 VAR_TARGET_HOST
    ~$ nc -vvn -w 1 -z VAR_TARGET_HOST 1-65535
    ~$ unicornscan -H -msf -Iv VAR_TARGET_HOST -p 1-65535

`` UDP

    ~$ nmap -nv -sU -sV -Pn -p- --reason --stats-every 60s --max-rtt-timeout=150ms --max-retries=1 VAR_TARGET_HOST
    ~$ nc -nnvu -w 1 -z VAR_TARGET_HOST 1-65535
    ~$ unicornscan -H -mU -Iv VAR_TARGET_HOST -p 1-65535

`` Fingerprinting

    ~$ amap -A VAR_TARGET_HOST VAR_TARGET_PORT
    ~$ nmap -A -sV -Pn -n -v VAR_TARGET_HOST -p VAR_TARGET_PORT

`` Stealthy

    `` Firewall bypassing

        ~$ nmap -T4 -sS -v -Pn -g 443 -n --top-ports 1500 VAR_TARGET_HOST

    `` Bypassing Windows IPsec filter

        ~$ nmap -sS -v -v -Pn -g 88 -O -A -p- VAR_TARGET_HOST

    `` Using zombies

        ~$ nmap VAR_TARGET_HOST -T2 --packet-trace -D RND,RND,RND,RND,RND,ME -Pn -v -sI VAR_ZOMBIE_HOST:443 --data-length -f --mtu 24 --script-args http.useragent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393"

    `` FTP bounce scanning

        ~$ nmap -b VAR_FTP_HOST -P0 -g 88 -n -v -sV -A --top-ports 500 VAR_TARGET_HOST

`` Scripts

    `` PowerShell

        @ snippets/windows/utils/PortScanning.ps1

    `` Port knocking

        ~$ for x in 7000 8000 9000; do nmap -Pn --host-timeout 201 --max-retries 0 -p $x VAR_TARGET_HOST; done
